---
title: "stats15final"
output:
  pdf_document: default
date: "2022-12-08"
---
FEEL FREE TO CHANGE ANYTHING UP HERE IN THE INTRODUCTION

IMPORTANT: WHEN PUSHING TO GITHUB, DONT COMMIT TO MAIN!!!!! MAKE A BRANCH!!!
IF YOU DONT KNOW HOW, READ HERE: https://docs.github.com/en/get-started/quickstart/github-flow

---------------------------------------

# Section 1: Background and Explanation of Data

## Introduction and Motivating Question

In the United States alone, 6.5 million dogs, cats, and other former pets are abandoned or lost every year and end up in shelters. In reality, only 3.2 million of these animals are adopted, while others who are not adopted within a certain time frame are euthanized. The Austin Animal Center, however, objects to this quota by being the largest no-kill animal shelter in the United States and providing care and shelter to over 18,000 animals each year. In contrast to other shelters, the animals that are not adopted within a certain time period are either transferred, returned to their original owner, and in very rare cases, euthanized. In this project, we will seek to answer the motivating question: what attributes affect whether a dog is adopted?

## Background

### The Austin Animal Center
The Austin Animal Center is the largest no-kill animal shelter in the United States that provides care and shelter to over 18,000 animals annually. They accept strays and owned animals regardless of age or health, and they accept all species and breeds of animals. However, for our analysis, we will be solely looking at the intake and outcomes of dogs at the center. As part of the AAC's efforts to help and care for animals in need, the organization makes available its accumulated data and statistics as part of the city of Austin's Open Data Initiative. The AAC datasets that we will be analysing outline the intakes and outcomes of animals at the center, of which many happen each day.

### Intakes and Outcomes
An _intake_ refers to an instance of an animal being admitted to the shelter, whether it be stray or owned. An _outcome_ refers to an animal leaving the shelter for any reason, whether they are adopted, transferred to another shelter, or pass away while staying in the shelter. Our data consists of two separate tables, one detailing outcomes and one detailing intakes. Each animal has a unique ID that is shared between the two tables.

### How Animals Come Into the Shelter
Some are brought in by owners who can no longer keep the animals. Others are found roaming the streets and brought in by animal control officers. In an ideal situation, an animal will only stay in a shelter until its owner returns or it is adopted. However, if that is not the case and they don't have enough room to indefinitely house all of the animals they receive, they will transfer them to a partner location.

### Data Structure
The intakes table has one entry for each instance of an animal coming into the shelter, and the outcomes table has one entry for each instance of an animal leaving the shelter. Each entry has details about the intake and outcome situations for the animals, which are specified in the "Variables" section. In our dataset, we will only be looking at dogs. Before any cleaning, the intakes and outcomes tables had a total of 145,851 entries and 145,914 entries, respectively, with 12 variables each.

### Importance of the Data
The importance of this data lies in the fact that it not only identifies characteristics people are looking for in dogs but also helps shelters that house dogs of all kinds decide whether to keep animals that exhibit certain characteristics at their current location or move them to a shelter that specializes in such characteristics. Suppose an elderly dog was staying at a shelter that couldn't get adopted due to a trend of people not adopting elderly dogs. If this was the case, the shelter might be better off transferring the dog to a shelter that is specifically designed for elderly dogs, where people looking to adopt elderly dogs are more likely to adopt the dog.


## Variables

+ Note: the variables started off as being in two separate tables, but the tables will be binded together during cleaning

### Explanatory Variables

***Age.upon.Intake*** and ***Age.upon.Outcome***: (char) the dog’s age at the time of the intake/outcome; an estimate if the dog is a rescue

***Breed***: (char) the dog’s primary and secondary breed (if it has one)

***Color***: (char) the dog’s primary and secondary color (if it has one); the one or two main colors that make up its coat

***DateTime***: (char) the date and time of the intake/outcome

### Response Variable

***Intake.Type*** and ***Outcome.Type***: (char)  the specifics of the intake/outcome situation for the dog, which are: 

outcomes: Adoption, Return to Owner, Transfer (moved to a rescue shelter), Euthanasia, Rto-Adopt (returned to the original owner through the adopotion process), Died, Disposal (same as died), Missing (the dog was lost at the center), and Stolen

intakes: Stray, Owner Surrender, Public Assist (the dog was brought to the shelter by an outside rescue org), Abandoned (there was a confirmed past owner that has abandoned the dog), Euthanasia Request (from the owner or otherwise), and Wildlife (same as stray)

# Section 2: Data Loading and Cleaning

```{r, message=FALSE, echo=FALSE}
library(tidyverse)
library(ggplot2)
library(lubridate)
library(forcats)
```

First, we load our data in.

```{r}
austin_intakes <- read.csv("aac_intakes.csv")
austin_outcomes <- read.csv("aac_outcomes.csv")
```

Then, we of course need to limit our dataset to just dogs.

```{r}
outcomes_filter <- austin_outcomes %>%
  filter(Animal.Type=="Dog")
intakes_filter <- austin_intakes %>% 
  filter(Animal.Type=="Dog")

outcomes_filter %>%
  select(Age.upon.Outcome, Animal.Type, Breed) %>%
  head()
```

Then, we need to eliminate all of the unused columns. The `Animal.Type` column will be unused since we've already filtered to just dogs.

```{r}
outcomes_s <- outcomes_filter %>%
  select(Animal.ID, Age.upon.Outcome, Breed, Color, DateTime, Outcome.Type)
intakes_s <- intakes_filter %>%
  select(Animal.ID, Age.upon.Intake, Breed, Color, DateTime, Intake.Type)

outcomes_s %>% 
  select(Age.upon.Outcome, Breed, Color) %>%
  head()
```

Then, we'll be binding the two tables together for the sake of analysis. An extra column will be added that will specify if each entry is an outcome/intake.

```{r}
o1 <- outcomes_s %>%
  rename("Age"="Age.upon.Outcome",
         "Type"="Outcome.Type")
o1$Action <- "outcome"

i1 <- intakes_s %>%
  rename("Age"="Age.upon.Intake",
         "Type"="Intake.Type")
i1$Action <- "intake"

aac <- rbind(o1, i1) %>% arrange(Animal.ID)
aac %>%
  select(Age, Breed, Color) %>%
  head()
```

Now, there is some cleaning to do in the `Type` column: some outcome/intake types are very similar to each other, and it will make more sense for our analysis if we lump them all together. Specifically, 

+ `Rto-Adopt` is the same as `Return to Owner`
+ `Wildlife` and `Abandoned` are the same as `Stray`
+ `Disposal` is the same as `Died`
+ `Stolen` is the same as `Lost`.

```{r}
aac <-
  aac %>%
  mutate(Type=case_when(
    Type=="Rto-Adopt" ~ "Return to Owner",
    Type=="Stolen" ~ "Lost",
    Type=="Disposal" ~ "Died",
    Type %in% c("Wildlife", "Abandoned") ~ "Stray",
    Type==Type ~ Type
  ))
```

Then, we'll use `lubridate` to add a column for all of the `DateTime` values converted to `date` instead of `char` objects, which will make it easier to compare them.

```{r}
aac <- aac
aac$DateTime <- mdy_hms(aac$DateTime)

aac$DateTime %>%
  head(3)
```

Next, note that the `Age` column is made up of character strings at the moment.

```{r}
aac$Age %>%
  head()
```

Such a variable will be much easier to analyse as an integer, so we will convert these to integers representing the dog's age in days.

```{r}
conv_to_int <- function(string)
{
  conv <- data.frame(
    c("week", "month", "year"),
    c(7, 30, 365)
  )
  tmp <- 1
  for (n in (1:3))
  {
     if(str_detect(string, conv[n, 1]))
    {
      tmp <- conv[n, 2]
    } 
  }
  ret_str <- str_extract(string, "^[0-9]+")
  ret_int <- as.integer(ret_str)
  return(as.integer(ret_int*tmp))
}

aac$Age.Days <- map_int(aac$Age, conv_to_int)

aac <- aac %>%
  select(-c(Age)) %>%
  relocate(Age.Days, .before=Breed)
         
aac$Age.Days %>%
  head()
```

Then, we'll simply remove all duplicate entries in our dataset.

```{r}
aac <- aac[!(duplicated(aac)), ]
```

Lastly, we'll be implementing a new column to denote the time between the last action and the one in the entry. The first entry for each dog will have an `NA` in this column.

```{r}
len <- function(d1, d2)
{
  retval <- int_length(interval(d1, d2))
  return(retval)
}
aac <-
aac %>%
  arrange(Animal.ID, DateTime) %>%
  group_by(Animal.ID) %>%
  mutate(Num.Action=row_number()) %>%
  ungroup() %>%
  mutate(Time.From.Last.Action=case_when(
    (Num.Action > 1) ~ len(lag(DateTime), DateTime)
  )) %>%
  select(-c(Num.Action))
aac %>%
  select(Animal.ID, Action, Time.From.Last.Action) %>%
  head()
```

# Section 2.1: Univariate Exploratory Analysis

## Breed

To start, we'll be looking at the `Breed` column.

It currently has the problem of being a bit too specific, where some breeds are unmixed, some are just labeled "Mix" while others have the breed mix specified, among other naming specifics; this leads to a large majority of the breed categories having <10 entries.

```{r}
aac %>%
  group_by(Breed) %>%
  summarise(n=n()) %>%
  ggplot(aes(x=n)) +
  geom_density(fill="light blue") +
  scale_x_log10() +
  xlab("Occurances of each unique breed in data")

aac %>%
  group_by(Breed) %>%
  summarise(n=n()) %>%
  summarise(breeds=n())
```

In order for our analysis to be a bit more useful, it will helpful to create less breed categories; we will be removing any "mix" labels and specifying all dogs by their primary breed.

```{r}
aac <- aac %>% 
  mutate(Breed=str_extract(Breed, "^[A-Za-z ]+")) %>% 
  mutate(Breed=str_replace(Breed, " Mix", ""))

aac %>%
  group_by(Breed) %>%
  summarise(n=n()) %>%
  ggplot(aes(x=n)) +
  geom_density(fill="light blue") +
  scale_x_log10() +
  xlab("Occurances of each unique breed in data")

aac %>%
  group_by(Breed) %>%
  summarise(n=n()) %>%
  summarise(breeds=n())

aac %>%
  select(Age.Days, Breed, Color) %>%
  head()
```

While there are still some breeds that show up <10 times, they now make up a minority of the data, and our analysis will be far more useful.

Let's look at the distribution of breeds in the data after modification.

```{r}
aac %>%
  group_by(Breed) %>%
  summarise(n=n()) %>%
  ggplot(aes(x=fct_rev(fct_reorder(Breed, n)), y=n)) + geom_col(fill="light blue", color="black")  +
  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  ylab("Appearances in Data") +
  ggtitle("breeds vs how often they appear in the data")
```

The distribution of breeds throughout the data appears *very* right skewed, so there are a small number of breeds that show up far more than any others. Let's look at those at the top:

```{r}
aac %>%
  group_by(Breed) %>%
  summarise(appearances=n()) %>%
  arrange(desc(appearances)) %>%
  head(10)
```

Unsurprisingly, Pit Bulls appear most often in the data, appearing in 24,799 entries out of 163,450 total entries (i.e. nearly a sixth). Pit Bulls are very common in animal shelters, since they tend to have a hard time finding owners due to the aggressive and dangerous reputation of the breed, and they are often abandoned by their owners for the same reason. Retrievers are not far behind Pit Bulls, however dogs of the breed are far more numerous than Pit Bulls, which can account for their many occurrences in the data.

## Action Type

Let's look at the distribution of action types in the data.

```{r}
aac %>%
  ggplot(aes(x=Type)) +
  geom_bar(fill="light blue", color="black") + 
  facet_wrap(~ Action, scale="free_x") +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))

n_o <- (filter(aac, Action=="outcome") %>% summarise(n=n()))[1,1]
n_i <- (filter(aac, Action=="intake") %>% summarise(n=n()))[1,1]

aac %>%
  filter(Action=="outcome") %>%
  group_by(Type) %>%
  summarise(percent_of_outcomes=round((n()/n_o)*100, 2))

aac %>%
  filter(Action=="intake") %>%
  group_by(Type) %>%
  summarise(percent_of_intakes=round((n()/n_i)*100, 2))
```

We can see that almost 50% of the dogs that leave the shelter are adopted, and well over 50% that enter are strays. Considering the findings from our analysis of the `Breed` column, it may be interesting to facet further by `Breed` comparing Pit Bulls and Retrievers, since they both appear very frequently in the data but likely for different reasons.

```{r}
aac %>%
  filter(Breed %in% c("Pit Bull", "Labrador Retriever")) %>%
  ggplot(aes(x=Type)) +
  geom_bar(fill="light blue", color="black") + 
  facet_grid(Breed ~ Action, scale="free_x") +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))

n_o_r <- (filter(aac, Action=="outcome", Breed=="Labrador Retriever") %>% summarise(n=n()))[1,1]
n_i_r <- (filter(aac, Action=="intake", Breed=="Labrador Retriever") %>% summarise(n=n()))[1,1]
n_o_p <- (filter(aac, Action=="outcome", Breed=="Pit Bull") %>% summarise(n=n()))[1,1]
n_i_p <- (filter(aac, Action=="intake", Breed=="Pit Bull") %>% summarise(n=n()))[1,1]

aac %>%
  filter(Action=="outcome", Breed %in% c("Labrador Retriever", "Pit Bull")) %>%
  group_by(Type) %>%
  summarise(percent_of_outcomes_LR=round((sum(Breed=="Labrador Retriever")/n_o_r)*100, 2),
            percent_of_outcomes_PB=round((sum(Breed=="Pit Bull")/n_o_p)*100, 2))

aac %>%
  filter(Action=="intake", Breed %in% c("Labrador Retriever", "Pit Bull")) %>%
  group_by(Type) %>%
  summarise(percent_of_intakes_LR=round((sum(Breed=="Labrador Retriever")/n_i_r)*100, 2),
            percent_of_intakes_PB=round((sum(Breed=="Pit Bull")/n_i_p)*100, 2))
```

Indeed, while about 53% of Retrievers' outcomes are adoptions, only about 43% of Pit Bulls' outcomes are adoptions: a difference of 10%! Conversely, "return to owner" for Retrievers was 10% greater than that for Pit Bulls. 

Additionally, while the actual difference is only about 3%, the percentage of outcomes for Pit Bulls that were euthanasia is around 2.5 times greater than that for Retrievers. All of these differences can be attributed to the aggressive reputation that Pit Bulls carry (or, in some cases such as euthanasia, the aggressive temperament they have).

## Age

Let's look at the distribution of ages throughout the data.

```{r}
aac %>%
  ggplot(aes(x=Age.Days)) + 
  geom_histogram(fill="light blue", color="black", bins=20) +
  xlab("age in days") +
  ggtitle("distribution of ages in days in the data")
```

The ages are certainly right-skewed, but it may be useful to dig deeper. The age may be somewhat dependent on what is happening to the dog, so we'll facet by `Type` and see if it's any different.

```{r}
aac %>%
  ggplot(aes(x=Age.Days)) + 
  geom_histogram(fill="light blue", color="black", bins=20) +
  xlab("age in days") +
  ggtitle("distribution of ages in days in the data") +
  facet_wrap(~ Type, scales="free")
```

The only distribution that is not right-skewed is `Euthanasia Request`, reflecting how the one of the main reasons older dogs come in is for euthanasia; many dogs come into the shelter because the owner loses or abandons them, and this is more likely to happen if the dog is younger, since they have more energy they are more likely to run away or the owner may feel that they cannot take care of them. 

It may be useful to bin the dogs' ages in categories for later. A numerical distribution may better help us understand how to bin them.

```{r}
quantile(aac$Age.Days, na.rm=TRUE)
```

## Color

The 'Color' column includes some interesting data. While some occurrences are just single colors (i.e. "White" or "Black") many are combinations, (i.e. "White/Tan" or "Black/White"). Sometimes colors appear in reverse order (i.e. "Black/White" and "White/Black). The distinction between these two cases isn't made clear, but for our purposes we will assume the first color to be dominant. 

In order to simplify the data, we will be removing the second color from any combinations which appear less than 50 times in the data. Additionally, combinations of the same color (i.e. "White/White") will be reduced to one color. Finally, we will be excluding any colors that appear less than 10 times in the data.

```{r}

aac_color <- aac %>%
  
  mutate(a=str_extract(Color, "^.+?(?=/|$)"),
         b=str_extract(Color, "[^/]*$")) %>%
  mutate(Color=case_when(
    a==b ~ a,
    a!=b ~ Color
  ))%>%
  
  group_by(Color) %>%
  mutate(n=n()) %>%
  
 # mutate(Color=case_when(
 #   n <= 50 ~ a
 # ))  %>%
  
  select(-c(a,b)) %>%
  
#for now just filtering out anything less than 50, but would like to do the above part eventually
  
  filter(n>=50)

aac_color %>%
  group_by(Color) %>%
  summarise(n=n()) %>%
  arrange(desc(n))

```

Now, when we look at the distribution, we can see that the majority of colors appear around 100-200 times in the data. There are some colors, however, that appear significantly more than others. All 10 of the most common colors appear over 5000 times. In order to investigate further, we will check to see if these colors have any relationship with breeds.

```{r}

aac_color %>%
  group_by(Color) %>%
  summarise(n=n()) %>%
  ggplot(aes(x=n)) +
  geom_density(fill="light blue") +
  scale_x_log10() +
  xlab("Occurances of each unique color in data")

aac_color %>%
  group_by(Color) %>%
  summarise(n=n()) %>%
  arrange(desc(n)) %>%
  head(10)

```

The most common color, "Black/White" appears almost 20000 times. We will look at that color specifically to see the most common breed types for Black/White dogs. 

```{r}

breed_percentage <- aac %>%
  count(Breed) %>%
  arrange(desc(n)) %>%
  mutate(total=sum(n)) %>%
  mutate(percentage_total = (n/total)*100) %>%
  select(Breed, percentage_total)

aac_color %>%
  filter(Color=="Black/White") %>%
  group_by(Breed) %>%
  summarise(n=n()) %>%
  filter(n>250) %>%
  
  inner_join(breed_percentage, by = "Breed") %>%
  mutate(n_vs_percent = n/percentage_total) %>%
  
  #To ensure proper proportional evaluation
  
  arrange(desc(n_vs_percent)) %>%
  head(10)

aac %>%
  group_by(Breed) %>%
  summarise(n=n()) %>%
  arrange(desc(n)) %>%
  head(10)

```

We can see that of the most common Black/White breeds (found by placing their occurrences against their percentages of all dogs), 7 appear in the most common breeds for the entire dataset.

(Maybe some more visualization idk)

## Time from last Action

[stuff]

# Section 2.2: Multivariate Exploratory Analysis

## Breed vs Time Spent in Shelter

It may be interesting to see if certain breeds spend more time in the shelter than others before being adopted. Since we will be taking an average of the time the breed spends in the shelter, we will only be looking at breeds with at least 15 adoption entries.

```{r}
aac %>%
  filter(!(is.na(Time.From.Last.Action))) %>%
  filter(Action=="outcome", Type=="Adoption") %>%
  group_by(Breed) %>%
  filter(n()>=15) %>%
  summarise(a=mean(Time.From.Last.Action)) %>%
  ggplot(aes(x=fct_rev(fct_reorder(Breed, a)), y=a)) + geom_col(fill="light blue", color="black")  +
  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  ylab("Avg Time Spent in Center") +
  ggtitle("breeds vs time spent in shelter before adoption")
```

We see a skew, though not as intensely as the distribution of breeds throughout the data. There are some that stick out, so let's look at the ones at the top.

```{r}
aac %>%
  filter(!(is.na(Time.From.Last.Action))) %>%
  filter(Action=="outcome", Type=="Adoption") %>%
  group_by(Breed) %>%
  summarise(avg_days_before_adoption=mean(Time.From.Last.Action)/86400) %>%
  arrange(desc(avg_days_before_adoption)) %>%
  head(10)
```

If you're unfamiliar with dog breeds then the `Dogo Argentino` may seem random, but its appearance actually closely resembles that of a Pit Bull.

![a Dogo Argentino on the left, and a Pit Bull on the right](./dogoargentino.jpg)

While the two breeds are actually not related genetically, they are often mistaken for each other. Thus, it suffers from the same bad rap that the Pit Bull has of being a dangerous breed. **In fact, 9/10 of the breeds in that top 10 are relatives of the Pit Bull, or breeds that look similar**. Only the Beauceron looks distinct from a Pit Bull, and it likely has such a high average time because it looks similar to the Doberman, another breed with an "aggressive" reputation.

Looking into the breeds at the tail end of the graph may give us some insight, as well.

```{r}
aac %>%
  filter(!(is.na(Time.From.Last.Action))) %>%
  filter(Action=="outcome", Type=="Adoption") %>%
  group_by(Breed) %>%
  filter(n()>=15) %>%
  summarise(avg_days_before_adoption=mean(Time.From.Last.Action)/86400) %>%
  arrange((avg_days_before_adoption)) %>%
  head(10)
```

dwnjankjnwanda people like cute dogs holllyyyyy shittttttttttttt

sorry its late and im passing out ill write something here later but the point is that all of thtese dogs that get adopted quickly are small and/or look cute, the largest i think is the cocker spaniel but that has funny looking ears so its cute

## Color vs Time in Shelter

```{r}

aac_color %>%
  filter(!(is.na(Time.From.Last.Action))) %>%
  filter(Action=="outcome", Type=="Adoption") %>%
  group_by(Color) %>%
  filter(n()>=50) %>%
  summarise(a=mean(Time.From.Last.Action/86400)) %>%
  ggplot(aes(x=fct_rev(fct_reorder(Color, a)), y=a)) + geom_col(fill="light blue", color="black")  +
  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank()) +
  ylab("Avg Days Spent in Center") +
  ggtitle("Color vs Days Spent in Shelter Before Adoption")

```

The skew for time spent in shelter before adoption isn't nearly as intense for color as it was for breed. 

```{r}

colors <- aac_color %>%
  select(Color, n) %>%
  group_by(Color) %>%
  summarise(n=n()) %>%
  arrange(desc(n))

sum(colors$n)

aac_color %>%
  filter(!(is.na(Time.From.Last.Action))) %>%
  filter(Action=="outcome", Type=="Adoption") %>%
  mutate(color_percentage = (n/160639)*100) %>%
  group_by(Color, color_percentage) %>%
  summarise(avg_days_before_adoption=mean(Time.From.Last.Action)/86400) %>%
  arrange(desc(avg_days_before_adoption)) %>%
  head(10)

aac_color %>%
  group_by(Color) %>%
  summarise(n=n()) %>%
  mutate(color_percentage = (n/160639)*100) %>%
  arrange(desc(color_percentage)) %>%
  select(Color, color_percentage) %>%
  head(10)

#dont know why it does that r console thing, I know its because im doing group by wrong but im only doing it because I wanna include other columns

```
What we do notice is that none of the 10 colors with the longest time until adoption appear in the 10 most common colors. In fact, the majority of these colors make up less than 0.5% of all colors. We will take the approach we used early when evaluating color alone to detect whether or not any of these colors are common for breeds with long adoption times.

```{r}

aac_color %>%
  filter(!(is.na(Time.From.Last.Action))) %>%
  filter(Action=="outcome", Type=="Adoption") %>%
  group_by(Color) %>%
  mutate(n=n()) %>%
  ungroup() %>%
  group_by(Breed) %>%
  mutate(avg_days_before_adoption=mean(Time.From.Last.Action)/86400) %>%
  ungroup() %>%
  
  group_by(Breed, Color, avg_days_before_adoption, n) %>%
  summarise(avg_days=mean(avg_days_before_adoption)) %>%
  
  # I know this is the ugliest code ever and just doesn't make sense but its the only way I could figure it out.
  
  ungroup() %>%
  group_by(Breed) %>%
  slice_max(n, n=1) %>%
  arrange(desc(avg_days_before_adoption)) %>%
  select(Breed, Color) %>%
  rename(most_common_color = Color)
  head(10)

```
Interestingly, none of the breeds with the longest adoption times' most common color is any of the colors with the longest adoption times. Perhaps dogs with bizarre or abnormal colors have a harder time being adopted.

```{r}

aac_color %>%
  filter(!(is.na(Time.From.Last.Action))) %>%
  filter(Action=="outcome", Type=="Adoption") %>%
  mutate(color_percentage = (n/160639)*100) %>%
  group_by(Color, color_percentage) %>%
  summarise(avg_days_before_adoption=mean(Time.From.Last.Action)/86400) %>%
  arrange(desc(color_percentage)) %>%
  head(10) %>%
  ungroup() %>%
  summarise(common_colors_avg_days = mean(avg_days_before_adoption))



```
Dogs with the most common colors are adopted on average in 27 days, while the colors with the longest adoption times all sit above 40 days. While the difference isn't huge, it is worth considering as to whether or not people are more likely to adopt dogs with common colors than those with abnormal combinations.

#Age vs. Time in Shelter

```{r}

aac %>%
  filter(!(is.na(Time.From.Last.Action))) %>%
  filter(Action=="outcome", Type=="Adoption") %>%
  mutate(days_before_adoption=Time.From.Last.Action/86400) %>%
  mutate(age_years = Age.Days/365) %>%
  select(age_years, days_before_adoption) %>%
  ggplot(aes(x=age_years,y=days_before_adoption)) +
  geom_point() 

```
alright im dead 

sorry this shit hard like im confused
ill get on more soon

also thought u were doing the bins thing for age so i ma just stop

# Section 3: Data Modeling

[stuff]

# Conclusion

[stuff]