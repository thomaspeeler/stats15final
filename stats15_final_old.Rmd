---
title: "STATS15 Final Project - FIFA Player Skills Analysis"
author: "Thomas Peeler, James Cobb, Mackenzie Smith, Ciara Smith"
output: pdf_document
date: "2022-11-8"
---
# Section 1: Introduction and Background

## Motivating Question

Soccer is widely considered the most popular sport in the world, with an estimated amount of global fans in the billions. Many make life-changing money due to their skill on the field; Paris Saint-Germain player Kylian Mbapp√© has a projected salary of over 100 million dollars during the 2022-23 season. Ability on the field is extremely important to both fans and players alike, and with this we aim to answer the motivating question: *what attributes make strong defensive players?*

## Background on FIFA and Soccer

#### General Professional Soccer: 
In soccer, a _league_ is an association made up of _clubs_, or teams, which exists to negotiate matches and competitions between those clubs. Each club can have as many players as they want, but most tend to be around 30. Unlike other sports, a player's team can change once per year via a transfer, in which one club will buy a player from another club for a negotiated amount of money.

In a match, there are 11 players to each team on the field: 10 outfielders and 1 goalkeeper. Outfielders can be generally put into three categories: defenders, midfielders, and forwards. Defenders aim to keep the ball away from their own net, forwards try to get the ball to the other team's net, and midfielders take the role of either position as necessary. Forwards will generally be worse at defending than defenders, and vice versa. 

#### FIFA Series: 
FIFA (aside from being a real federation) is a series of soccer video games that features many real soccer leagues, clubs, and players from all over the world. One can create their own teams or use ones that already exist to play matches against others or a computer. In the game, each soccer player has a wide range of numerical statistics; these range from specifics such as crossing and heading skill to more general stats like international recognition. FIFA games are released on a yearly basis, and these stats are also updated with each entry to the series.

#### How Ratings are Collected: 
The stats for each player are based on real life; EA, the developer of FIFA, employs many scouts to watch, in total, thousands of professional soccer matches and take notes on each player. They then report their own ratings back to EA, who use their own vetting system before implementing the ratings into the game. This process is repeated for each yearly entry of the series, in order to keep up with how players' skills and position in the soccer world can change over time.

## The Data

#### Structure: 
Each observational unit is one row of the data, representing one player and their attributes for that year; each player will have one measurement of attributes for each year.

### Variables: 
To note, there are 6 summary statistics for each yearly measure of attributes: `defending, shooting, pace, passing, dribbling, physic`. These are made up of weighted averages of the other specific attributes:

*Pace*: movement_sprint_speed\*0.55 + movement_acceleration\*0.45

*Shooting*: attacking_finishing\*0.45 + power_long_shots\*0.2 + power_shot_power\*0.2 + mentality_positioning\*0.05 + mentality_penalties\*0.05 + attacking_volleys\*0.05

*Passing*: attacking_short_passing\*0.35 + mentality_vision\*0.2 + attacking_crossing\*0.2 + skill_long_passing\*0.15 + skill_curve\*0.05 + skill_fk_accuracy\*0.05

*Dribbling*: skill_dribbling\*0.5 + skill_ball_control\*0.35 + movement_agility\*0.1 + movement_balance\*0.05

*Defending*: defending_marking_awareness\*0.3 + defending_standing_tackle\*0.3 + mentality_interceptions\*0.2 + attacking_heading_accuracy\*0.1 + defending_sliding_tackle\*0.1

*Physical*: power_strength\*0.5 + power_stamina\*0.25 + mentality_aggression\*0.2 + power_jumping\*0.05



```{r setup, include=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(naniar)
```

```{r}
#load all csv
players15 <- read.csv("players_15.csv")
players16 <- read.csv("players_16.csv")
players17 <- read.csv("players_17.csv")
players18 <- read.csv("players_18.csv")
players19 <- read.csv("players_19.csv")
players20 <- read.csv("players_20.csv")
players21 <- read.csv("players_21.csv")
players22 <- read.csv("players_22.csv")

#add year column for each and bind
players15$year = 2015
players16$year = 2016
players17$year = 2017
players18$year = 2018
players19$year = 2019
players20$year = 2020
players21$year = 2021
players22$year = 2022

players <- rbind(players15, players16, players17, players18, players19, players20, players21, players22)

#filter out goalkeepers
players_ng <- players %>% filter(!(player_positions=="GK"))

#select desired columns
players_s <- players_ng %>% select(c(sofifa_id, year, short_name, league_name, club_name, weight_kg, height_cm, age, player_positions, defending, shooting, pace, passing, dribbling, physic))

#unique entry id for each year/player combination
players_s <- players_s %>% mutate(entry_id=paste(as.character(sofifa_id), "_", as.character(year), sep="")) %>% relocate(entry_id, .before = sofifa_id)
```


```{r}
#take only first position
players_s <- players_s %>% mutate(player_positions=str_extract(player_positions, "^[A-Z]+"))
```

```{r}
players_s %>% group_by(player_positions) %>% summarise(d=mean(defending), s=mean(shooting))
```


```{r}
#replace all empty strings with NA
players_na <- players_s %>% 
  replace(players_s=='', NA)
```

```{r}
#demonstrating how all NAs are entries with no league/club; we can keep them
def_nona <- players_na %>% na.omit()

players_s %>%
  filter(!(entry_id %in% def_nona$entry_id)) %>%
  head()

no_league_club <- players_na %>% select(-c(league_name, club_name)) %>% na.omit()

players_s %>%
  filter(!(entry_id %in% no_league_club$entry_id))%>%
  head()
```

```{r}

```



